# RNA-Seq Analysis Cluster Template
# Use Case: RNA sequencing analysis and differential expression
# Domain: Bioinformatics
# Optimized for: Alignment, quantification, and differential expression analysis
# Included software: STAR, hisat2, salmon, kallisto, DESeq2, edgeR, multiqc
# Instance recommendations: Memory-optimized for alignment (r5 family)
# Estimated costs: ~$2-3/hour for typical r5.4xlarge usage

cluster:
  name: rnaseq-cluster
  region: us-east-1

compute:
  # Medium head node for job management and light analysis
  head_node: t3.xlarge

  queues:
    # Memory-optimized queue for alignment (STAR, hisat2)
    # STAR requires ~30GB RAM for human genome
    - name: alignment
      instance_types:
        - r5.4xlarge   # 16 vCPU, 128GB RAM - good for STAR
        - r5.8xlarge   # 32 vCPU, 256GB RAM - large genomes
      min_count: 0
        max_count: 15

    # Compute-optimized queue for quantification (salmon, kallisto)
    # These tools are CPU-intensive but need less memory
    - name: quantify
      instance_types:
        - c5.4xlarge   # 16 vCPU, 32GB RAM
        - c5.9xlarge   # 36 vCPU, 72GB RAM
      min_count: 0
      max_count: 20

    # General purpose for QC and preprocessing
    - name: qc
      instance_types:
        - m5.2xlarge   # 8 vCPU, 32GB RAM
        - m5.4xlarge   # 16 vCPU, 64GB RAM
      min_count: 0
      max_count: 10

software:
  spack_packages:
    # Compilers and MPI
    - gcc@11.3.0
    - openmpi@4.1.4

    # Alignment tools
    - star@2.7.10b
    - hisat2@2.2.1
    - bowtie2@2.4.5
    - bwa@0.7.17

    # Quantification tools
    - salmon@1.9.0
    - kallisto@0.48.0
    - rsem@1.3.3

    # Quality control
    - fastqc@0.11.9
    - multiqc@1.13
    - rseqc@4.0.0
    - trimmomatic@0.39
    - fastp@0.23.2

    # Utilities
    - samtools@1.17
    - bedtools2@2.30.0
    - subread@2.0.3  # for featureCounts

    # Languages for analysis
    - python@3.10
    - r@4.2.0
    - perl@5.36.0

    # Python packages for RNA-seq
    - py-pandas@2.0.0
    - py-numpy@1.24.0
    - py-matplotlib@3.7.0
    - py-seaborn@0.12.0

    # Data processing
    - hdf5@1.14.0
    - parallel@20230422

users:
  - name: rnaseq1
    uid: 5001
    gid: 5001
  - name: rnaseq2
    uid: 5002
    gid: 5002
  - name: rnaseq3
    uid: 5003
    gid: 5003

data:
  s3_mounts:
    # Reference genomes and annotations
    - bucket: my-reference-genomes
      mount_point: /shared/references

    # Raw FASTQ files
    - bucket: my-rnaseq-data
      mount_point: /shared/fastq

    # Aligned BAM files
    - bucket: my-alignments
      mount_point: /shared/alignments

    # Analysis results
    - bucket: my-rnaseq-results
      mount_point: /shared/results
